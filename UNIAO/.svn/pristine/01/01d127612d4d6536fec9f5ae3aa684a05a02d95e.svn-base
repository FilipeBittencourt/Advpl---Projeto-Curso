#INCLUDE "PROTHEUS.CH"
#INCLUDE "TBICONN.CH"

/*
------------------------------------------------------------------------------------------------------------
Função		: MT120FIM
Tipo		: Ponto de Entrada
Descrição	: Após a restauração do filtro da FilBrowse depois de fechar a operação realizada no pedido de 
			  compras, é a ultima instrução da função A120Pedido.
Uso			: Compras
Parâmetros	: 
Retorno	: 
------------------------------------------------------------------------------------------------------------
Atualizações:
- 05/10/2015 - Henrique - Construção inicial do fonte
------------------------------------------------------------------------------------------------------------
*/
User Function MT120FIM()
	Local lPedBloq := .F.
	//Local nOpcao	:= PARAMIXB[1]   // Opção Escolhida pelo usuario 
	//Local cNumPC	:= PARAMIXB[2]   // Numero do Pedido de Compras
	Local nOpcA	:= PARAMIXB[3]  // Indica se a ação foi Cancelada = 0  ou Confirmada = 1.CODIGO DE APLICAÇÃO DO USUARIO  

	SetKey( VK_F6,Nil )
	SetKey( VK_F7,nil) 
	
	If nOpcA == 0 .OR. AllTrim(FunName())=='VIXA116'
		Return
	EndIf
	
	lPedBloq := SC7->C7_CONAPRO == 'B'
	
	U_VIX259CR(PARAMIXB) // Busca o trecho do fornecedor (ZZ0) e copia para o trecho do PC tabela (ZZE)
		
	If lPedBloq .AND. !IsBlind()
		If MsgYesNo("Gostaria de transmitir o pedido para o fornecedor?")
			U_VIXA114()
		EndIf
	EndIf

Return