#include "rwmake.ch"        // incluido pelo assistente de conversao do AP5 IDE em 29/01/01
#IFNDEF WINDOWS
#DEFINE PSAY SAY
#ENDIF

User Function Bia111()        // incluido pelo assistente de conversao do AP5 IDE em 29/01/01

	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Declaracao de variaveis utilizadas no programa atraves da funcao    Ё
	//Ё SetPrvt, que criara somente as variaveis definidas pelo usuario,    Ё
	//Ё identificando as variaveis publicas do sistema utilizadas no codigo Ё
	//Ё Incluido pelo assistente de conversao do AP5 IDE                    Ё
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды

	Local nI

	SetPrvt("CNOMEPROG,CTAMANHO,CTITULO,CDESC1,CDESC2,CDESC3")
	SetPrvt("ARETURN,ALINHA,AORDEM,LPODECOMP,LTEMDIC,LGRAVPARAM")
	SetPrvt("NLASTKEY,CERRO,LERRO,CCBTXT,NCBCONT,CALIAS")
	SetPrvt("NL,M_PAG,CCABEC1,CCABEC2,CNUMINI,CNUMFIM")
	SetPrvt("CPRODINI,CPRODFIM,CLOCINI,CLOCFIM,CMASCARA,CCNTRMASC")
	SetPrvt("NI,ACAMPOS,CARQTEMP,NTOTQUANT,CLINDIVISORIA,CDADOS")
	SetPrvt("_CALIAS,CPERG,AREGS,NJ,")

	/*/
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤└o	 Ё BIA111	  Ё Autor Ё WLADIMIR ILLIUSHENKO  Ё Data Ё 11/12/00 Ё╠╠
	╠╠цддддддддддеддддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤└o Ё Relatorio de Movimentacao de Romaneio								 Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠Ё Uso		 Ё SIGAEST																		 Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	/*/
	#IFNDEF WINDOWS
	// Movido para o inicio do arquivo pelo assistente de conversao do AP5 IDE em 29/01/01 ==> 		#DEFINE PSAY SAY
	#ENDIF

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Declaracao de variaveis																  Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	cNomeProg  := "BIA111"
	cTamanho   := "M"
	cTitulo	  := "Relatorio de Movimentacao de Romaneio"
	cDesc1	  := "Emite relatorio de Movimentacao de Romaneio                "
	cDesc2	  := "                                                           "
	cDesc3	  := "                                                           "
	aReturn	  := { "Zebrado", 1,"Administracao", 1, 2, 1, "",1 }
	aLinha	  := { }
	aOrdem	  := { }
	lPodeComp  := .T.
	lTemDic	  := .F.
	lGravParam := .F.
	nLastKey   := 0
	cErro 	  := ""
	lErro 	  := .F.

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Variaveis utilizadas para impressao.												  Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	cCbTxt	 := space(10)
	nCbCont	 := 0
	cAlias	 := "SZ7"
	nL 		 := 80
	m_pag 	 := 1
	cCabec1	 := "NUMERO          PRODUTO      DESCRICAO                      LOCALIZACAO           QUANTIDADE  DOCUMENTO"
	cCabec2	 := "                                                                                                       "
	//XXXXXXXXXXXXXX	XXXXXXXXXXX  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX XXXXXXXXXXXXXXX   XXX.XXX.XXX,XX	XXXXXXXXXX
	//0					 17									  48					 57				71 			  85				 99				113

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Definicao dos parametros. Cria os parametros caso nao existam.			  Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	//mv_par01 Do Numero 			?
	//mv_par02 Ate o Numero 		?
	//mv_par03 Do Produto			?
	//mv_par04 Ate o Produto		?
	//mv_par05 Da Localizacao		?
	//mv_par06 Ate a Localizacao	?
	//mv_par07 Mascara de Produtos?
	//fValidPerg()

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Envia controle para a funcao SETPRINT.											  Ё
	//Ё Verifica Posicao do Formulario na Impressora.									  Ё
	//Ё Solicita os parametros para a emissao do relatorio							  Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	cNomeProg := SetPrint(cAlias,cNomeProg,cNomeProg,@cTitulo,cDesc1,cDesc2,cDesc3,lTemDic,aOrdem,lPodeComp,cTamanho)
	Pergunte(cNomeProg,lGravParam)
	if (nLastKey==27) .OR. (LastKey()==27)
		Return
	endif

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Aceita par┐metros e faz ajustes necess═rios 									  Ё
	//Ё Gera mascar de contra-mascara de produtos.										  Ё
	//Ё		Ex.: "****B*E****" -> "****X*X****"                                 Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	cNumIni	 := MV_PAR01
	cNumFim	 := MV_PAR02
	cProdIni  := MV_PAR03
	cProdFim  := MV_PAR04
	cLocIni	 := MV_PAR05
	cLocFim	 := MV_PAR06
	cMascara  := MV_PAR07
	cCntrMasc := ""
	for nI:=1 to len(cMascara)
		cCntrMasc := cCntrMasc + iif(SubStr(cMascara,nI,1)#"*","X","*")
	next
	SetDefault(aReturn,cAlias)

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Rotinas.																					  Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	Processa({|| fCriaTemp()	})// Substituido pelo assistente de conversao do AP5 IDE em 29/01/01 ==> 	Processa({|| Execute(fCriaTemp)	})
	Processa({|| fAcumula()	})// Substituido pelo assistente de conversao do AP5 IDE em 29/01/01 ==> 	Processa({|| Execute(fAcumula)	})
	Processa({|| fImprime()	})// Substituido pelo assistente de conversao do AP5 IDE em 29/01/01 ==> 	Processa({|| Execute(fImprime)	})
	Processa({|| fApagaTemp() })// Substituido pelo assistente de conversao do AP5 IDE em 29/01/01 ==> 	Processa({|| Execute(fApagaTemp) })

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Se a impress└o for em Disco, chama SPOOL 										Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	if aReturn[5]==1
		Set Printer to
		Commit
		OurSpool(cNomeProg)
	endif

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Libera relatorio para Spool da Rede												Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	Ft_PFlush()
Return

/*/
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбддддддддддддддддддддддддддддддддддддддддд©╠╠
╠╠ЁFuncao	 Ё fCriaTempЁ Autor Ё WLADIMIR ILLIUSHENKO						  Ё╠╠
╠╠цддддддддддеддддддддддадддддддаддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁDescricao Ё Cria uma tabela temporaria para preparacao do relatorio.   Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁUso		 Ё BIA111																	  Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
// Substituido pelo assistente de conversao do AP5 IDE em 29/01/01 ==> Function fCriaTemp
Static Function fCriaTemp()
	aCampos := {}
	AADD(aCampos, {"NUMERO    ", "C", 14, 0})
	AADD(aCampos, {"PRODUTO   ", "C", 11, 0})
	AADD(aCampos, {"DESCRICAO ", "C", 30, 0})
	AADD(aCampos, {"LOCALIZ   ", "C", 15, 0})
	AADD(aCampos, {"QUANTIDADE", "N", 14, 2})
	AADD(aCampos, {"DOCUMENTO ", "C", 06, 0})

	cArqTemp := CriaTrab(aCampos, .T.)
	DbUseArea(.T.,,cArqTemp,"TMP")
	DbCreateInd(cArqTemp+".001","NUMERO+PRODUTO+LOCALIZ",{||NUMERO+PRODUTO+LOCALIZ})
	OrdListClear()
	OrdListAdd(cArqTemp+".001")
Return


/*/
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбддддддддддддддддддддддддддддддддддддддддд©╠╠
╠╠ЁFuncao	 Ё fAcumula Ё Autor Ё WLADIMIR ILLIUSHENKO						  Ё╠╠
╠╠цддддддддддеддддддддддадддддддаддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁDescricao Ё 																			  Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁUso		 Ё BIA111																	  Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
// Substituido pelo assistente de conversao do AP5 IDE em 29/01/01 ==> Function fAcumula
Static Function fAcumula()

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Le o SZ7 em busca das movimentacoes de romaneio.								Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	DbSelectArea("SZ7")
	DbSetOrder(1)
	ProcRegua(SZ7->(LastRec()))
	DbGoTop()
	do while !SZ7->(EOF())

		IncProc("Consultando romaneios ...")

		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Verifica se o numero do romaneio pertence ao periodo informado nos ... Ё
		//Ё parametros.																				Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		if (SZ7->Z7_ROMAN < cNumIni) .OR. (SZ7->Z7_ROMAN > cNumFim)
			SZ7->(DbSkip())
			Loop
		endif

		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Verifica se a localizacao do romaneio pertence ao periodo informado ...Ё
		//Ё nos parametros.																			Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		if (SZ7->Z7_LOCALIZ < cLocIni) .OR. (SZ7->Z7_LOCALIZ > cLocFim)
			SZ7->(DbSkip())
			Loop
		endif

		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Verifica se o produto do romaneio pertence ao periodo informado nos ...Ё
		//Ё parametros.																				Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		if (SZ7->Z7_PRODUTO < cProdIni) .OR. (SZ7->Z7_PRODUTO > cProdFim)
			SZ7->(DbSkip())
			Loop
		endif

		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Verifica se o produto pertence a mascara informada.							Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		if Transform(SZ7->Z7_PRODUTO,cCntrMasc) #cMascara
			SZ7->(DbSkip())
			Loop
		endif

		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Grava os dados obtidos no arquivo temporario.									Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		DbSelectArea("TMP")
		DbSetOrder(1)
		RecLock("TMP",.T.)
		TMP->NUMERO 	 := SZ7->Z7_ROMAN
		TMP->PRODUTO	 := SZ7->Z7_PRODUTO
		TMP->DESCRICAO  := SZ7->Z7_DESCRI
		TMP->LOCALIZ	 := SZ7->Z7_LOCALIZ
		TMP->QUANTIDADE := SZ7->Z7_QUANT
		TMP->DOCUMENTO  := SZ7->Z7_DOC
		MsUnlock()

		SZ7->(DbSkip())
	enddo
Return

/*/
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбдддддддддддбдддддддбдддддддддддддддддддддддддддддддддддддддд©╠╠
╠╠ЁFuncao	 Ё fImprime  Ё Autor Ё WLADIMIR ILLIUSHENKO						  Ё╠╠
╠╠цддддддддддедддддддддддадддддддадддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁDescricao Ё Imprime os dados da tabela temporaria. 						  Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
// Substituido pelo assistente de conversao do AP5 IDE em 29/01/01 ==> Function fImprime
Static Function fImprime()
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Inicializa variaveis usadas na impressao.										Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	nTotQuant	  := 0
	cLinDivisoria := Replicate("-",32)

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Abre a tabela temporaria. 															Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	DbSelectArea("TMP")
	DbGoTop()
	ProcRegua(TMP->(LastRec()))
	do while !TMP->(EOF())

		IncProc("Imprimindo ...")

		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Impressao do cabecalho.																  Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		if nL >= 60
			nL := Cabec(cTitulo,cCabec1,cCabec2,cNomeProg,cTamanho) + 2
		endif

		cDados := ""
		cDados := cDados + padr(TMP->NUMERO   ,14," ") + space(02)
		cDados := cDados + padr(TMP->PRODUTO  ,11," ") + space(02)
		cDados := cDados + padr(TMP->DESCRICAO,30," ") + space(01)
		cDados := cDados + padr(TMP->LOCALIZ  ,15," ") + space(03)
		cDados := cDados + Transform(TMP->QUANTIDADE,iif(TMP->QUANTIDADE==0,"           -  ","@E 999,999,999.99")) + space(2)
		cDados := cDados + padr(TMP->DOCUMENTO,06," ") + space(02)
		@nL,000 Psay cDados
		nL 		 := nL + 1
		nTotQuant := nTotQuant + TMP->QUANTIDADE

		TMP->(DbSkip())
	enddo

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Impressao do cabecalho.																  Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	if nL >= 60
		nL := Cabec(cTitulo,cCabec1,cCabec2,cNomeProg,cTamanho) + 2
	endif

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Imprime o total geral dos produtos listados.									  Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	@ nL,000 PSAY space(60)+cLinDivisoria
	nL := nL + 1
	cDados := ""
	cDados := cDados + space(60) + "TOTAL GERAL --->" + space(02)
	cDados := cDados + Transform(nTotQuant,iif(nTotQuant==0,"           -  ","@E 999,999,999.99"))
	@nL,000 Psay cDados
	nL := nL + 1
	@ nL,000 PSAY space(60)+cLinDivisoria
	nL := nL + 1

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Imprime rodape.																			  Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	Roda(nCbCont, cCbtxt, cTamanho)
Return

/*/
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддбдддддддбддддддддддддддддддддддддддддддддддддддд©╠╠
╠╠ЁFuncao	 Ё fApagaTemp Ё Autor Ё WLADIMIR ILLIUSHENKO 					  Ё╠╠
╠╠цддддддддддеддддддддддддадддддддаддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁDescricao Ё Apaga a tabela temporaria. 										  Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁUso		 Ё BIA111																	  Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
// Substituido pelo assistente de conversao do AP5 IDE em 29/01/01 ==> Function fApagaTemp
Static Function fApagaTemp()
	DbSelectArea("TMP")
	DbCloseArea("TMP")
	FErase(cArqTemp+".*")
Return

/*/
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFuncao	 ЁVALIDPERG Ё Autor Ё Joao Carlos de AndradeЁ Data Ё 12/09/00 Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescricao Ё Verifica as perguntas incluindo-as caso nao existam		  Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁUso		 Ё Especifico - Incesa													  Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/
// Substituido pelo assistente de conversao do AP5 IDE em 29/01/01 ==> Function fValidPerg
Static Function fValidPerg()

	Local nI, nJ

	_cAlias := Alias()
	DbSelectArea("SX1")
	DbSetOrder(1)
	cPerg := PADR(cNomeProg,6)

	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Grupo/Ordem/Pergunta/Variavel/Tipo/Tamanho/Decimal/Presel/GSC/Valid/Var01/Def01/Cnt01/Var02/Def02/Cnt02/Var03/Def03/Cnt03/Var04/Def04/Cnt04/Var05/Def05/Cnt05 Ё
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	aRegs := {}
	AADD(aRegs,{cPerg,"01","Do Numero          ?","mv_ch1","C",08,0,0,"G",""        ,"mv_par01","","","","","","","","","","","","","","",""})
	AADD(aRegs,{cPerg,"02","Ate o Numero       ?","mv_ch2","C",08,0,0,"G",""        ,"mv_par02","","","","","","","","","","","","","","",""})
	AADD(aRegs,{cPerg,"03","Do Produto         ?","mv_ch3","C",11,0,0,"G",""        ,"mv_par03","","","","","","","","","","","","","","",""})
	AADD(aRegs,{cPerg,"04","Ate o Produto      ?","mv_ch4","C",11,0,0,"G",""        ,"mv_par04","","","","","","","","","","","","","","",""})
	AADD(aRegs,{cPerg,"05","Da Localizacao     ?","mv_ch5","C",15,0,0,"G",""        ,"mv_par05","","","","","","","","","","","","","","",""})
	AADD(aRegs,{cPerg,"06","Ate a Localizacao  ?","mv_ch6","C",15,0,0,"G",""        ,"mv_par06","","","","","","","","","","","","","","",""})
	AADD(aRegs,{cPerg,"07","Mascara de Produtos?","mv_ch7","C",11,0,0,"G","NaoVazio","mv_par07","","","","","","","","","","","","","","",""})

	for nI:=1 to Len(aRegs)
		if !dbSeek(cPerg+aRegs[nI,2])
			RecLock("SX1",.T.)
			for nJ:=1 to FCount()
				FieldPut(nJ,aRegs[nI,nJ])
			next
			MsUnlock()
			DbCommit()
		endif
	next

	DbSelectArea(_cAlias)
Return

